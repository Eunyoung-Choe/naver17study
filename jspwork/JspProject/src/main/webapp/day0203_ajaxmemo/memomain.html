<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
   <title>502 html study</title>
   <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400..700&family=Gaegu&family=Jua&family=Nanum+Pen+Script&family=Playwrite+AU+SA:wght@100..400&family=Single+Day&display=swap" rel="stylesheet">
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
   <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
   <style>
   body *{
      font-family: 'Jua';
   }
   </style>
   <script type="text/javascript">
   		$(function(){
   			list(); // 처음 로딩 시 전체 메모 출력
   			
   			// 저장 버튼 이벤트
   			$("#btnsave").click(function(){
   				let avata = $("#selavata").val();
   				let nickname = $("#nickname").val();
   				let message = $("#message").val();
   				
   				$.ajax({
   					type: "get",
   					dataType: "xml",
   					data:{"avata":avata,"nickname":nickname,"message":message},
   					url:"./insertmemo.jsp",
   					success: function(res){
   						alert($(res).find("result").text());
   						
   						$("#selavata").val("");
   						$("#nickname").val("");
   						$("#message").val("");
   						
   						// 목록 다시 출력
   						list();
   					}
   				});
   			});
   		});
   		
   		// 이 함수가 없어서 값 저장이 안 됐다..
   		function list()
   		{
   			
   		}
   </script>
</head>
<body>
	<div style="margin:20px;" style="width:300px;">
		<h5 class="alert alert-danger">Memo Ajax CRUD</h5>
		
		<div class="input-group">
			<select id="selavata">
				<option value="../image/avata/s1.JPG">스웨터 소년</option>
				<option value="../image/avata/s3.JPG">파란 원피스 소녀</option>
				<option value="../image/avata/s4.JPG">핑크 원피스 소녀</option>
				<option value="../image/avata/s10.JPG">피아노 치는 소년</option>
				<option value="../image/avata/s6.JPG">신난 스누피</option>
			</select>
			&nbsp;
			<img src="" class="photoavata" width="40">
			
			<script type="text/javascript">
				$(".photoavata").attr("src", $("#selavata").val());
				
				// 이벤트
				$("#selavata").change(function(){
					$(".photoavata").attr("src", $(this).val());
				});
			</script>
			
			<input type="text" class="form-control" id="nickname" placeholder="닉네임">
		</div>
		
		<div class="input-group">
			<input type="text" id="message" class="form-control" style="margin-top:10px;" placeholder="메세지 입력">
			&nbsp;&nbsp;
			<button type="button" class="btn btn-sm btn-success" id="btnsave">저장</button>			
		</div>
		
		<!-- 출력할 위치 -->
		<div class="memolist alert alert-warning" style="margin-top:10px; width:350px">111</div>
	</div>
</body>
</html>